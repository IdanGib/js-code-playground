<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>API</title>
    <link rel="stylesheet" href="index.css">
     
    <link rel="stylesheet" href="lib/codemirror-5.61.0/lib/codemirror.css">
    <link rel="stylesheet" href="lib/codemirror-5.61.0/addon/hint/show-hint.css">

    <script src="lib/codemirror-5.61.0/lib/codemirror.js"></script>
    <script src="lib/codemirror-5.61.0/addon/hint/show-hint.js"></script>
    <script src="lib/codemirror-5.61.0/addon/hint/javascript-hint.js"></script>
    <script src="lib/codemirror-5.61.0/addon/edit/closebrackets.js"></script>
    <script src="lib/codemirror-5.61.0/mode/javascript/javascript.js"></script>
</head>
<body>
    <div class='app'>
        <div id="code" class="box">
           
        </div>
        <div id="console" class="box">
        </div>
        <div id="footer" class="box">
            <span>Run: Ctrl + Q</span>
            <span>Clean: Ctrl + B</span>
        </div>
    </div>

    <script src="/index.js"></script>
    <script>
        async function main() {
            try {

                const env = { url: `http://localhost:3000` };
                const code = document.getElementById('code');
                const cnsl = document.getElementById('console');
                window.console.log = (msg) => {
                    cnsl.innerText += ('' + msg);
                }
                const codeMirror = CodeMirror(code, {
                    mode:  "javascript",
                    lineNumbers: true,
                    autoCloseBrackets: true,
                    autocorrect: true,
                    extraKeys: {
                        "Ctrl-Space": "autocomplete", 
                        "Ctrl-S": () => {},
                        "Ctrl-B": () => {
                            cnsl.innerText = '';
                        },
                        "Ctrl-Q": () => {
                            const code = codeMirror.getValue();
                            if(code) {
                                try {
                                    const result = eval(code);
                                    cnsl.innerText = result;  
                                } catch(e) {
                                    cnsl.innerText = `ERROR: ${e.message}`;  
                                }
                        
                            }
                           
                        },
                    }
                });
                codeMirror.on('change', (cm, data) => {});
            } catch(e) {
                console.error(e);
            }
        }
        
        main();

    </script>
</body>
</html>